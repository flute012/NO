<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>頁面查看</title>
    <style>
        .comparison-content { margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>頁面查看</h1>
    
    <div>
        <h3>選擇要查看的頁面：</h3>
        <input type="checkbox" id="page1" value="1.html">
        <label for="page1">1.html</label>
        <input type="checkbox" id="page2" value="2.html">
        <label for="page2">2.html</label>
        <input type="checkbox" id="page3" value="3.html">
        <label for="page3">3.html</label>
        <input type="checkbox" id="page4" value="4.html">
        <label for="page4">4.html</label>
    </div>
    
    <div>
        <h3>選擇要查看的元素：</h3>
        <input type="radio" id="compareA1" name="compareElement" value="a1" checked>
        <label for="compareA1">查看 &lt;div id="a1"&gt;</label>
        <input type="radio" id="compareA2" name="compareElement" value="a2">
        <label for="compareA2">查看 &lt;div id="a2"&gt;</label>
    </div>
    
    <button onclick="viewOrComparePages()">查看/比較</button>
    
    <div id="resultArea"></div>

    <script>
        
async function viewOrComparePages() {
    const selectedPages = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
    const compareElement = document.querySelector('input[name="compareElement"]:checked').value;
    const resultArea = document.getElementById('resultArea');
    resultArea.innerHTML = '';

    if (selectedPages.length === 0) {
        alert('請至少選擇一個頁面');
        return;
    }

    for (const page of selectedPages) {
        try {
            console.log(`嘗試載入頁面: ${page}`);
            // 使用相對路徑或絕對路徑，取決於您的部署方式
            const response = await fetch(page);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const html = await response.text();
            console.log(`成功載入頁面 ${page}, 內容長度: ${html.length}`);

            // 使用正則表達式直接查找指定 ID 的內容
            const regex = new RegExp(`<div\\s+id="${compareElement}"[^>]*>([\\s\\S]*?)<\\/div>`, 'i');
            const match = html.match(regex);
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'comparison-content';
            if (match && match[1]) {
                const content = match[1].trim();
                contentDiv.innerHTML = `<h3>${page} 中的 #${compareElement} 內容：</h3><div>${content}</div>`;
                console.log(`找到 #${compareElement} 元素，內容長度: ${content.length}`);
            } else {
                contentDiv.innerHTML = `<h3>${page} 中未找到 #${compareElement} 元素</h3>`;
                console.log(`在 ${page} 中未找到 #${compareElement} 元素`);
            }
            resultArea.appendChild(contentDiv);
        } catch (error) {
            console.error(`無法載入 ${page}:`, error);
            const errorDiv = document.createElement('div');
            errorDiv.className = 'comparison-content';
            errorDiv.innerHTML = `<h3>錯誤：無法載入 ${page}</h3><p>錯誤詳情：${error.message}</p>`;
            resultArea.appendChild(errorDiv);
        }
    }
}

// 如果需要，可以保留這部分來處理文件名
document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(cb => {
        // 如果您的文件名總是以 'L' 開頭，可以保留這行
        // 否則，可以根據實際情況調整或刪除
        cb.value = cb.value.replace(/^(\d+)\.html$/, 'L$1.html');
    });
});
        
    </script>
</body>
</html>